# I Just Testing For IDOR and Access Control cuz THAT'S WHAT WE'RE ALWAYS LOOKING FOR AS BUG BOUNTY RESEARCHERS OR TACTORS RIGHT WE'RE LOOKING FOR TECH DEBT WE'RE LOOKING FOR COMPLEXITY , BECAUSE WHERE THERE'S MORE COMPLEXITY THERE'S AREAS FOR THINGS TO FALL THROUGH THE CRACKS THERE COULD BE OVERSIGHTS AND THAT'S WHAT WE WANT TO KIND OF DIG INTO AS ATTACKERS AND SEE IF WE CAN FIND THE BUGS 

### Taking Note:

## Environments -> Information about the Application
- Two Types:
    1. Console 
        - Clients
        - Groups 
    2. Company
        - Team
            - Accountant
            - Approver
            - Clerk
            - Auditor
            - Administrator
            - Payer
- Features vary depending on type

### Objects

- User
- Team
- Console
- Clients
- Groups

## Mechanisms

- User
    - Change Name 
    - Change Email 
    - Language
    - Change Password 
    - 2fa 

- Team
    - Invite Users
    - Delete Users 
    - Change Role 
    - Update Iformation 

- Console
- Clients
- Groups

### Application Boundaries 

1. User-Company -> User-Company
    - IDOR
2. Team -> Team 
    - RBAC 
3. User-Team ->  User-Team -> Information 
    - IDOR
4. User-Console -> User-Console
    - IDOR
5. Groups -> Groups
    - RBAC


## Roles 
Team member roles:

- Accountant
    - Can manage the payables processes, but cannot pay bills. Primary tasks are to enter bills and syncing with your accounting system.

- Approver
    - Reviews bills and vendor credits and authorizes them for payment.
    
- Clerk
    - Can only enter bills.

- Auditor (View-only)
    - Can view all account and transaction history, but can't edit or approve anything.

- Administrator
    - Oversees the company's use of BILL and has permission to access all functions.

- Payer
    - Pays approved bills and records payments from outside of BILL.


#### Validation IDORs
`"Current user or organization does not have valid permissions." `
#### Validation RBAC
`"Current user or organization does not have valid permissions."`
#### Validation Session
` sid=!bnR9bjMVwSd0VI5F59ngu7057h-GFzFKzHhBh2gntx1xgor-9Pp27_oz-D6OEMJOJ.02;`
## GraphQL Operations 

Operations Validated with USER-ID -> User -> Role
--------------------------------------------------------------------------

Now Let's Test 
First i start with the lowest two roles 
- Approver
    `"userId":"00602AZDBHDUHKA9npu0"`
- Auditor (View-only)
    `"userId":"00602NMJEAFLWDJ9npu2"`

### GrapQL Operations -> EndPoints
- Unfortunately this tests Fail
    - GetUser
        - FAIL
    - UserProfileFields
        - FAIL
    - SessionInfo
        - FAIL
    - consoleUserDetails
        - FAIL

### Attack Vectors 

# UPDATE User-NAME
POST -> https://EXAMPLE.com/query?op=UpdateUserNameOrRole 
`{"operationName":"UpdateUserNameOrRole","variables":{"input":{"userId":"00602MQFLJJIUWJ9nmeh","firstName":"muhamma","lastName":"wagehtest"}`

- Machanism: Update User Name 
- CRUD: Update
- Object: User
- Boundary: User -> User (IDOR)
- Unique Identifier: "id":"00602MQFLJJIUWJ9nmeh" (?)
    - Are the id number sequencial ?
            - No, only digital and letters
    - Is the id value used to pull the larger user object ?
            - Yes. unless they use the unique token at
             `sid=!bnR9bjMVwSd0VI5F59ngu7057h-GFzFKzHhBh2gntx1xgor-9Pp27_oz-D6OEMJOJ.02;`
    - How does session come into play ?
            - Not at all, cookie isn;t needed, unless `sid=!bnR9bjMVwSd0VI5F59ngu7057h-GFzFKzHhBh2gntx1xgor-9Pp27_oz-D6OEMJOJ.02;`
             is the session token 
    Tests: Updating The Name 
    - TEST 1 Replace the user ID
        - Result: FAIL -> "Current user or organization does not have valid permissions." 

# Add User(ADMIN) in the Team 
- tests
    - test 1 add user in the team with Auditor (View-only) -> ROLE 
        - RESULT: Fail 
    - test 2 add user in the team with Approver -> ROLE 
     - RESULT: Fail
# Change NAME in the Team
- CHANGE NAME WITH Approver -> ROLE 
    - RESULT: FAIL "Current user or organization does not have valid permissions."

# Change ROLE in the Team
- CHANGE (ROLE) WITH Approver -> ROLE 
    - RESULT: FAIL "Current user or organization does not have valid permissions."
# READ DATE TEAM 
- READ -> ROLE WITH Approver -> ROLE 
    - RESULT: FAIL
-------------------------------------------------
Now, after reading the documentation, I understand that the Approver role cannot access account information of other users within the team. This means the approver is part of the team but does not have visibility or access to any other user's information.

<img width="1046" height="150" alt="VIEWW" src="https://github.com/user-attachments/assets/fd1145c3-bb8b-4448-a88d-81faa4e0ba73" />


So I was thinking:

- Can I Access The Profil User Team Information That i Don't Have Permission To Access To ? I Was Testing RBAC And IDOR But IDOR Is User to User in Another Account Not In The Same Company Team!
- 
# Read Data -> Auditor (View-only) 

PUT - > https://EXAMPLE.com/query

<img width="1489" height="757" alt="Approverr" src="https://github.com/user-attachments/assets/8ba01109-c1f6-440e-a665-02227a077127" />

- Test:
    - Change The User-id (Approver) -> ROLE -> Auditor (View-only) 
    - RESULT: Success
      <img width="1478" height="733" alt="Auditor" src="https://github.com/user-attachments/assets/cb492b15-6d99-4d13-849b-0b27e988b11f" />


**Now I Access The Information Auditor Role But I Was Think The Bug Is Not Have Any Impact, So I Report It As A Low, After Response, It Was a Medium 4.3 But Unfortunately Is Duplicate !

<img width="270" height="828" alt="Report" src="https://github.com/user-attachments/assets/d9f17a44-55f0-46d8-9047-2116adf95132" />


It's sad, right? No, if you find a vulnerability then you've succeeded, whether it's duplicate or not. This is proof that you know how to find vulnerability.!

Best Luck.
